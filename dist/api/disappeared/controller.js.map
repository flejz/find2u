{"version":3,"sources":["../../../src/api/disappeared/controller.js"],"names":["create","res","next","user","body","bodymen","then","disappeared","view","catch","index","querymen","query","select","cursor","find","populate","disappeareds","map","show","params","findById","id","update","merge","save","destroy","remove","get","req","disappeared_id"],"mappings":"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","file":"controller.js","sourcesContent":["import _ from 'lodash'\nimport { success, notFound, badRequest, authorOrAdmin } from '../../services/response/'\nimport { Disappeared } from '.'\n\nexport const create = ({ user, bodymen: { body } }, res, next) => \n  Disappeared.create({ ...body, user })\n    .then((disappeared) => disappeared.view(true))\n    .then(success(res, 201))\n    .catch(next)\n\nexport const index = ({ querymen: { query, select, cursor } }, res, next) =>\n  Disappeared.find(query, select, cursor)\n    .populate('user')\n    .then((disappeareds) => disappeareds.map((disappeared) => disappeared.view()))\n    .then(success(res))\n    .catch(next)\n\nexport const show = ({ params }, res, next) =>\n  Disappeared.findById(params.id)\n    .populate('user')\n    .then(notFound(res))\n    .then((disappeared) => disappeared ? disappeared.view() : null)\n    .then(success(res))\n    .catch(next)\n\nexport const update = ({ user, bodymen: { body }, params }, res, next) =>\n  Disappeared.findById(params.id)\n    .populate('user')\n    .then(notFound(res))\n    .then(authorOrAdmin(res, user, 'user'))\n    .then((disappeared) => disappeared ? _.merge(disappeared, body).save() : null)\n    .then((disappeared) => disappeared ? disappeared.view(true) : null)\n    .then(success(res))\n    .catch(next)\n\nexport const destroy = ({ user, params }, res, next) =>\n  Disappeared.findById(params.id)\n    .then(notFound(res))\n    .then(authorOrAdmin(res, user, 'user'))\n    .then((disappeared) => disappeared ? disappeared.remove() : null)\n    .then(success(res, 204))\n    .catch(next)\n\nexport const get = (req, res, next) =>\n    Disappeared.findById(req.body.disappeared_id)\n      .then((disappeared) => {\n        req.disappeared = disappeared;\n        next();\n      })\n      .catch(badRequest(res))"]}