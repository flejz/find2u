{"version":3,"sources":["../../../src/api/disappeared/index.test.js"],"names":["app","userSession","anotherSession","disappeared","beforeEach","create","email","password","user","anotherUser","id","test","post","send","access_token","name","birth_date","disappearance_date","mobile_contact","status","body","expect","toBe","toEqual","get","Array","isArray","put","delete","query"],"mappings":"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","file":"index.test.js","sourcesContent":["import request from 'supertest-as-promised'\nimport { signSync } from '../../services/jwt'\nimport express from '../../services/express'\nimport { User } from '../user'\nimport routes, { Disappeared } from '.'\n\nconst app = () => express(routes)\n\nlet userSession, anotherSession, disappeared\n\nbeforeEach(async () => {\n  const user = await User.create({ email: 'a@a.com', password: '123456' })\n  const anotherUser = await User.create({ email: 'b@b.com', password: '123456' })\n  userSession = signSync(user.id)\n  anotherSession = signSync(anotherUser.id)\n  disappeared = await Disappeared.create({ user })\n})\n\ntest('POST /disappeareds 201 (user)', async () => {\n  const { status, body } = await request(app())\n    .post('/')\n    .send({ access_token: userSession, name: 'test', birth_date: 'test', disappearance_date: 'test', mobile_contact: 'test' })\n  expect(status).toBe(201)\n  expect(typeof body).toEqual('object')\n  expect(body.name).toEqual('test')\n  expect(body.birth_date).toEqual('test')\n  expect(body.disappearance_date).toEqual('test')\n  expect(body.mobile_contact).toEqual('test')\n  expect(typeof body.user).toEqual('object')\n})\n\ntest('POST /disappeareds 401', async () => {\n  const { status } = await request(app())\n    .post('/')\n  expect(status).toBe(401)\n})\n\ntest('GET /disappeareds 200', async () => {\n  const { status, body } = await request(app())\n    .get('/')\n  expect(status).toBe(200)\n  expect(Array.isArray(body)).toBe(true)\n})\n\ntest('GET /disappeareds/:id 200', async () => {\n  const { status, body } = await request(app())\n    .get(`/${disappeared.id}`)\n  expect(status).toBe(200)\n  expect(typeof body).toEqual('object')\n  expect(body.id).toEqual(disappeared.id)\n})\n\ntest('GET /disappeareds/:id 404', async () => {\n  const { status } = await request(app())\n    .get('/123456789098765432123456')\n  expect(status).toBe(404)\n})\n\ntest('PUT /disappeareds/:id 200 (user)', async () => {\n  const { status, body } = await request(app())\n    .put(`/${disappeared.id}`)\n    .send({ access_token: userSession, name: 'test', birth_date: 'test', disappearance_date: 'test', mobile_contact: 'test' })\n  expect(status).toBe(200)\n  expect(typeof body).toEqual('object')\n  expect(body.id).toEqual(disappeared.id)\n  expect(body.name).toEqual('test')\n  expect(body.birth_date).toEqual('test')\n  expect(body.disappearance_date).toEqual('test')\n  expect(body.mobile_contact).toEqual('test')\n  expect(typeof body.user).toEqual('object')\n})\n\ntest('PUT /disappeareds/:id 401 (user) - another user', async () => {\n  const { status } = await request(app())\n    .put(`/${disappeared.id}`)\n    .send({ access_token: anotherSession, name: 'test', birth_date: 'test', disappearance_date: 'test', mobile_contact: 'test' })\n  expect(status).toBe(401)\n})\n\ntest('PUT /disappeareds/:id 401', async () => {\n  const { status } = await request(app())\n    .put(`/${disappeared.id}`)\n  expect(status).toBe(401)\n})\n\ntest('PUT /disappeareds/:id 404 (user)', async () => {\n  const { status } = await request(app())\n    .put('/123456789098765432123456')\n    .send({ access_token: anotherSession, name: 'test', birth_date: 'test', disappearance_date: 'test', mobile_contact: 'test' })\n  expect(status).toBe(404)\n})\n\ntest('DELETE /disappeareds/:id 204 (user)', async () => {\n  const { status } = await request(app())\n    .delete(`/${disappeared.id}`)\n    .query({ access_token: userSession })\n  expect(status).toBe(204)\n})\n\ntest('DELETE /disappeareds/:id 401 (user) - another user', async () => {\n  const { status } = await request(app())\n    .delete(`/${disappeared.id}`)\n    .send({ access_token: anotherSession })\n  expect(status).toBe(401)\n})\n\ntest('DELETE /disappeareds/:id 401', async () => {\n  const { status } = await request(app())\n    .delete(`/${disappeared.id}`)\n  expect(status).toBe(401)\n})\n\ntest('DELETE /disappeareds/:id 404 (user)', async () => {\n  const { status } = await request(app())\n    .delete('/123456789098765432123456')\n    .query({ access_token: anotherSession })\n  expect(status).toBe(404)\n})\n"]}